import{a as c}from"./chunk-GMT66XAW.js";import{b as l}from"./chunk-CNTZWMNJ.js";import{E as i,I as a,N as s}from"./chunk-GRGODEBP.js";var p=class n{http=s(l);apiUrl=c.apiUrl+"/api/auth";login(t,e){return this.http.post(`${this.apiUrl}/login`,{email:t,password:e}).pipe(i(r=>{let o=r.token||r.accessToken||r.jwt;if(!o)throw new Error("Token no recibido del backend");localStorage.setItem("token",o)}))}register(t,e,r){return this.http.post(`${this.apiUrl}/register`,{name:t,email:e,password:r})}logout(){localStorage.removeItem("token")}getToken(){return localStorage.getItem("token")}isAuthenticated(){return!!this.getToken()}getCurrentUser(){let t=this.getToken();if(!t)return null;try{return JSON.parse(atob(t.split(".")[1]))}catch{return null}}getUserRoles(){let t=this.getCurrentUser();return t?t.roles||t.authorities||[]:[]}hasRole(t){return this.getUserRoles().includes(t)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=a({token:n,factory:n.\u0275fac,providedIn:"root"})};export{p as a};
